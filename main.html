<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>RSVP</title>
<style>
  body{font-family:system-ui;background:#f6f8fb;display:flex;
       justify-content:center;align-items:center;height:100vh;margin:0;}
  .card{background:#fff;padding:2rem 3rem;border-radius:8px;
        box-shadow:0 2px 8px rgba(0,0,0,.08);max-width:380px;width:100%;}
  h1{margin:0 0 1rem;text-align:center;font-size:1.4rem;}
  input[type=text]{width:100%;padding:.6rem;margin:.4rem 0 .8rem;
                   border:1px solid #ccc;border-radius:4px;
                   text-transform:uppercase;letter-spacing:.05em;}
  .btn{background:#0066ff;color:#fff;border:none;padding:.7rem 1.4rem;
       border-radius:4px;font-weight:600;cursor:pointer;width:100%;}
  .btn:disabled{opacity:.6;cursor:not-allowed;}
  .success{display:none;text-align:center;color:#2e7d32;font-weight:600;margin-top:1rem;}
</style>
</head>
<body>
  <div class="card">
    <h1>Enter your invite code</h1>

    <form id="rsvpForm">
      <!-- 6-char code; HTML pattern enforces A-Z / 0-9 -->
      <input id="code" type="text" required placeholder="ABC123"
             pattern="[A-Za-z0-9]{6}" minlength="6" maxlength="6">

      <div style="margin:.6rem 0 1.2rem">
        <label><input type="radio" name="attendance" value="yes" required> Yes</label>
        <label style="margin-left:1.2rem"><input type="radio" name="attendance" value="no" required> No</label>
      </div>

      <button class="btn" type="submit">Submit</button>
    </form>

    <p id="thanks" class="success">Thanks â€” saved!</p>
  </div>

  <!-- Firebase modular SDKs -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-app.js";
    import { getFirestore, doc, setDoc, serverTimestamp }
            from "https://www.gstatic.com/firebasejs/10.10.0/firebase-firestore.js";

    // ðŸ”§ 1) Paste *your* config here
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyD5N9MzxEeVghPM_R7CDlBrlWlZMAU95T0",
      authDomain: "gerzlngelairsvp.firebaseapp.com",
      projectId: "gerzlngelairsvp",
      storageBucket: "gerzlngelairsvp.firebasestorage.app",
      messagingSenderId: "367774281093",
      appId: "1:367774281093:web:b134d69d29e370c19fe8ec",
      measurementId: "G-RQH6M218SX"
    };

    /* Init */
    const app = initializeApp(firebaseConfig);
    const db  = getFirestore(app);

    /* Form handler */
    const form   = document.getElementById('rsvpForm');
    const button = form.querySelector('button');
    const thanks = document.getElementById('thanks');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      button.disabled = true;

      const code      = document.getElementById('code').value.trim().toUpperCase();
      const attending = (new FormData(form)).get('attendance') === 'yes';

      try {
        /* Use the invite code itself as the document ID */
        await setDoc(doc(db, 'rsvps', code), {
          attending,
          submitted: serverTimestamp()
        });

        form.reset();
        thanks.style.display = 'block';
      } catch (err) {
        alert('Error â€“ please try again.');
        console.error(err);
      }
      button.disabled = false;
    });
  </script>
</body>
</html